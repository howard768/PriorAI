<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLP-1 RCM Intelligence Platform - Prior Authorization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Smooth scrolling for anchor links */
        html {
            scroll-behavior: smooth;
        }
        
        /* Tab styles */
        .tab-button {
            position: relative;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            background-color: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tab-button:hover {
            color: #374151;
            background-color: #f9fafb;
        }
        
        .tab-button.active {
            color: #2563eb;
            background-color: #fff;
        }
        
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #2563eb;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Required field indicator */
        .required-indicator {
            color: #ef4444;
            margin-left: 2px;
        }
        
        /* Payer-specific field highlighting */
        .payer-required {
            border-color: #2563eb !important;
        }
        
        .payer-optional {
            opacity: 0.6;
        }
        
        /* Dropzone styles */
        .dropzone {
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .dropzone:hover {
            border-color: #9ca3af;
            background-color: #f9fafb;
        }
        
        .dropzone.dragover {
            border-color: #2563eb;
            background-color: #eff6ff;
        }
        
        /* Checklist item states */
        .checklist-item {
            transition: all 0.2s;
        }
        
        .checklist-item.complete {
            opacity: 0.8;
        }
        
        /* Loading animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                    </svg>
                    <div>
                        <h1 class="text-xl font-semibold text-gray-900">GLP-1 RCM Intelligence Platform</h1>
                        <p class="text-sm text-gray-500">AI-Powered Prior Authorization</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="relative p-2 text-gray-400 hover:text-gray-500">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                        </svg>
                        <span class="absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500"></span>
                    </button>
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium">
                            DC
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-900">Dr. Carter</p>
                            <p class="text-xs text-gray-500">Endocrinology</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Tabbed Form -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg border border-gray-200 shadow-sm">
                    <!-- Tab Navigation -->
                    <div class="border-b border-gray-200">
                        <nav class="flex -mb-px">
                            <button class="tab-button active" onclick="switchTab('patient-payer')">
                                Patient & Payer
                            </button>
                            <button class="tab-button" onclick="switchTab('clinical-case')">
                                Clinical Case
                            </button>
                            <button class="tab-button" onclick="switchTab('treatment-medication')">
                                Treatment & Medication
                            </button>
                            <button class="tab-button" onclick="switchTab('documentation-submission')">
                                Documentation & Submission
                            </button>
                        </nav>
                    </div>

                    <!-- Tab Content -->
                    <div class="p-6">
                        <!-- Tab 1: Patient & Payer -->
                        <div id="patient-payer" class="tab-content active">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Patient Information</h3>
                            
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Patient Name
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="text" id="patientName" value="Margaret Thompson" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Age
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="number" id="patientAge" value="52" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Gender
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <select id="patientGender" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        <option selected>Female</option>
                                        <option>Male</option>
                                        <option>Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        BMI
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="number" id="patientBMI" value="31.2" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>

                            <h3 class="text-lg font-medium text-gray-900 mb-4">Provider & Practice Information</h3>
                            
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Provider NPI Number
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="text" id="providerNPI" placeholder="1234567890" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Practice Tax ID
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="text" id="practiceTaxId" placeholder="XX-XXXXXXX" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>

                            <h3 class="text-lg font-medium text-gray-900 mb-4">Insurance Information</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    Insurance Payer
                                    <span class="required-indicator">*</span>
                                </label>
                                <select id="payerSelect" onchange="updatePayerRequirements()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                    <option value="">Select a payer...</option>
                                    <option value="unitedhealthcare">UnitedHealthcare</option>
                                    <option value="anthem">Anthem</option>
                                    <option value="aetna">Aetna</option>
                                    <option value="bcbs">Blue Cross Blue Shield</option>
                                    <option value="humana">Humana</option>
                                    <option value="cigna">Cigna</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Plan Type
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <select id="planType" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        <option value="">Select plan type...</option>
                                        <option value="commercial">Commercial</option>
                                        <option value="medicare">Medicare</option>
                                        <option value="medicaid">Medicaid</option>
                                        <option value="medicare-advantage">Medicare Advantage</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Member ID
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="text" id="memberId" placeholder="Member ID" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                        </div>

                        <!-- Tab 2: Clinical Case -->
                        <div id="clinical-case" class="tab-content">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Diagnosis Information</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    Primary Diagnosis (ICD-10)
                                    <span class="required-indicator">*</span>
                                </label>
                                <div class="flex gap-2">
                                    <input type="text" id="primaryDiagnosisCode" placeholder="E11.9" class="w-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                    <input type="text" id="primaryDiagnosisDesc" placeholder="Type 2 diabetes mellitus without complications" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <p class="mt-1 text-xs text-gray-500">Start typing to search ICD-10 codes</p>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    Secondary Diagnoses (ICD-10)
                                </label>
                                <textarea id="secondaryDiagnoses" rows="2" placeholder="E66.9 - Obesity, unspecified&#10;I10 - Essential hypertension" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"></textarea>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    Relevant CPT Codes
                                </label>
                                <input type="text" id="cptCodes" placeholder="99213, 82947, 83036" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                            </div>

                            <h3 class="text-lg font-medium text-gray-900 mb-4">Laboratory Values</h3>
                            
                            <div class="grid grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        HbA1c (%)
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="number" id="hba1c" step="0.1" placeholder="8.5" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Fasting Glucose (mg/dL)
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="number" id="fastingGlucose" value="156" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Date of Labs
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="date" id="labDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                            
                            <h4 class="font-medium text-gray-900 mb-3">Additional Lab Values</h4>
                            
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Total Cholesterol (mg/dL)
                                    </label>
                                    <input type="number" id="totalCholesterol" placeholder="220" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        LDL Cholesterol (mg/dL)
                                    </label>
                                    <input type="number" id="ldlCholesterol" placeholder="140" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        ALT (U/L)
                                    </label>
                                    <input type="number" id="alt" placeholder="35" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        AST (U/L)
                                    </label>
                                    <input type="number" id="ast" placeholder="30" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Creatinine (mg/dL)
                                    </label>
                                    <input type="number" id="creatinine" step="0.1" placeholder="0.9" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        eGFR (mL/min/1.73mÂ²)
                                    </label>
                                    <input type="number" id="egfr" placeholder="85" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                            </div>
                        </div>

                        <!-- Tab 3: Treatment & Medication -->
                        <div id="treatment-medication" class="tab-content">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Requested Medication</h3>
                            
                            <div class="grid grid-cols-3 gap-4 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Medication Name
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <select id="medicationName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        <option value="">Select medication...</option>
                                        <option value="semaglutide">Semaglutide (Ozempic/Wegovy)</option>
                                        <option value="tirzepatide">Tirzepatide (Mounjaro)</option>
                                        <option value="liraglutide">Liraglutide (Victoza/Saxenda)</option>
                                        <option value="dulaglutide">Dulaglutide (Trulicity)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Dosage
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <input type="text" id="dosage" placeholder="0.25 mg" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        Frequency
                                        <span class="required-indicator">*</span>
                                    </label>
                                    <select id="frequency" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        <option value="">Select frequency...</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="daily">Daily</option>
                                        <option value="twice-weekly">Twice weekly</option>
                                    </select>
                                </div>
                            </div>

                            <h3 class="text-lg font-medium text-gray-900 mb-4">Step Therapy History</h3>
                            
                            <div class="space-y-4" id="stepTherapyList">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-2 gap-4 mb-3">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                                Previous Medication
                                            </label>
                                            <input type="text" placeholder="Metformin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                                Duration
                                            </label>
                                            <input type="text" placeholder="6 months" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">
                                            Reason for Discontinuation
                                        </label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                                            <option value="">Select reason...</option>
                                            <option value="ineffective">Ineffective/Inadequate response</option>
                                            <option value="side-effects">Intolerable side effects</option>
                                            <option value="contraindicated">Contraindicated</option>
                                            <option value="allergic">Allergic reaction</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <button type="button" onclick="addStepTherapy()" class="mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium">
                                + Add Another Medication
                            </button>
                            
                            <h3 class="text-lg font-medium text-gray-900 mt-6 mb-4">Current Medications</h3>
                            
                            <textarea id="currentMedications" rows="3" placeholder="List current medications with doses..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">Metformin 1000mg BID, Atorvastatin 40mg daily</textarea>
                        </div>

                        <!-- Tab 4: Documentation & Submission -->
                        <div id="documentation-submission" class="tab-content">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Supporting Documentation</h3>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Upload Documents
                                </label>
                                <div class="dropzone" id="dropzone" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                    </svg>
                                    <p class="mt-2 text-sm text-gray-600">
                                        Drop files here or <button type="button" class="text-blue-600 hover:text-blue-700">browse</button>
                                    </p>
                                    <p class="text-xs text-gray-500 mt-1">PDF, DOC, DOCX up to 10MB</p>
                                </div>
                                <div id="fileList" class="mt-3 space-y-2"></div>
                            </div>
                            
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Submission Options</h3>
                            
                            <div class="space-y-3 mb-6">
                                <label class="flex items-center">
                                    <input type="radio" name="submissionMethod" value="electronic" checked class="mr-3 text-blue-600 focus:ring-blue-500">
                                    <div>
                                        <span class="font-medium">Electronic Submission</span>
                                        <p class="text-sm text-gray-500">Fastest option - Direct payer integration</p>
                                    </div>
                                </label>
                                
                                <label class="flex items-center">
                                    <input type="radio" name="submissionMethod" value="fax" class="mr-3 text-blue-600 focus:ring-blue-500">
                                    <div>
                                        <span class="font-medium">Fax Submission</span>
                                        <p class="text-sm text-gray-500">Traditional method - 24-48 hour processing</p>
                                    </div>
                                </label>
                                
                                <label class="flex items-center">
                                    <input type="radio" name="submissionMethod" value="portal" class="mr-3 text-blue-600 focus:ring-blue-500">
                                    <div>
                                        <span class="font-medium">Payer Portal</span>
                                        <p class="text-sm text-gray-500">Manual upload to payer website</p>
                                    </div>
                                </label>
                            </div>
                            
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Additional Notes</h3>
                            
                            <textarea id="additionalNotes" rows="4" placeholder="Any additional information for the reviewer..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: AI Pre-Submission Assistant -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg border border-gray-200 shadow-sm sticky top-24">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <h2 class="text-lg font-medium text-gray-900 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                            AI Pre-Submission Assistant
                        </h2>
                    </div>
                    <div class="p-6 space-y-6">
                        <!-- Submission Confidence Score -->
                        <div>
                            <div class="flex justify-between items-baseline mb-2">
                                <h3 class="text-sm font-medium text-gray-700">Submission Confidence</h3>
                                <span id="confidenceScore" class="text-2xl font-bold text-red-600">12%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div id="confidenceBar" class="bg-red-500 h-2.5 rounded-full transition-all duration-300" style="width: 12%"></div>
                            </div>
                            <p id="confidenceText" class="mt-2 text-sm text-gray-500 italic">
                                Please select a payer to see specific requirements.
                            </p>
                        </div>

                        <!-- Dynamic Requirements Checklist -->
                        <div>
                            <h3 class="text-sm font-medium text-gray-700 mb-3">Requirements Checklist</h3>
                            <div id="checklistContent" class="space-y-3">
                                <!-- Default checklist before payer selection -->
                                <div class="checklist-item">
                                    <div class="flex items-start">
                                        <svg class="w-5 h-5 text-yellow-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                        </svg>
                                        <span class="text-sm font-semibold text-gray-700">Select Insurance Payer</span>
                                    </div>
                                    <p class="ml-7 text-xs text-gray-500 mt-1">Required to determine specific authorization requirements</p>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="space-y-3">
                            <button id="submitBtn" disabled class="w-full bg-blue-600 text-white px-4 py-2 rounded-md font-medium opacity-50 cursor-not-allowed transition-all duration-200">
                                Submit for Authorization
                            </button>
                            <button class="w-full text-blue-600 hover:text-blue-700 text-sm font-medium">
                                Save as Draft
                            </button>
                        </div>

                        <!-- Summary Metrics -->
                        <div class="pt-6 border-t border-gray-200 space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Forms Completed Today</span>
                                <span class="font-medium text-gray-700">12</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Average Approval Rate</span>
                                <span class="font-medium text-green-600">78%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Payer-specific requirements database
        const payerRequirements = {
            unitedhealthcare: {
                required: ['patientName', 'patientAge', 'patientGender', 'patientBMI', 'providerNPI', 'practiceTaxId', 
                          'primaryDiagnosisCode', 'hba1c', 'fastingGlucose', 'labDate', 'medicationName', 'dosage', 
                          'frequency', 'stepTherapy', 'currentMedications'],
                optional: ['totalCholesterol', 'ldlCholesterol', 'alt', 'ast', 'creatinine', 'egfr', 'documents'],
                specific: 'Requires documented failure of metformin for at least 3 months'
            },
            anthem: {
                required: ['patientName', 'patientAge', 'patientGender', 'patientBMI', 'providerNPI', 'practiceTaxId',
                          'primaryDiagnosisCode', 'hba1c', 'labDate', 'medicationName', 'dosage', 'frequency',
                          'stepTherapy', 'currentMedications', 'creatinine', 'egfr'],
                optional: ['fastingGlucose', 'totalCholesterol', 'ldlCholesterol', 'alt', 'ast', 'documents'],
                specific: 'Requires renal function tests and cardiovascular risk assessment'
            },
            aetna: {
                required: ['patientName', 'patientAge', 'patientGender', 'patientBMI', 'providerNPI', 'practiceTaxId',
                          'primaryDiagnosisCode', 'hba1c', 'fastingGlucose', 'labDate', 'medicationName', 'dosage',
                          'frequency', 'stepTherapy', 'currentMedications', 'documents'],
                optional: ['totalCholesterol', 'ldlCholesterol', 'alt', 'ast', 'creatinine', 'egfr'],
                specific: 'Requires documentation of lifestyle modifications attempted'
            }
        };

        // Field mapping for checklist display
        const fieldLabels = {
            patientName: 'Patient Name',
            patientAge: 'Patient Age',
            patientGender: 'Patient Gender',
            patientBMI: 'Patient BMI',
            providerNPI: 'Provider NPI Number',
            practiceTaxId: 'Practice Tax ID',
            primaryDiagnosisCode: 'Primary Diagnosis (ICD-10)',
            hba1c: 'HbA1c Level',
            fastingGlucose: 'Fasting Glucose',
            labDate: 'Lab Date',
            medicationName: 'Requested Medication',
            dosage: 'Medication Dosage',
            frequency: 'Medication Frequency',
            stepTherapy: 'Step Therapy History',
            currentMedications: 'Current Medications',
            totalCholesterol: 'Lipid Panel',
            creatinine: 'Renal Function Tests',
            egfr: 'eGFR',
            documents: 'Supporting Documents'
        };

        // Tab switching functionality
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            // Update checklist based on current form state
            updateChecklist();
        }

        // Update payer-specific requirements
        function updatePayerRequirements() {
            const selectedPayer = document.getElementById('payerSelect').value;
            
            if (!selectedPayer) {
                resetToDefaultChecklist();
                return;
            }
            
            const requirements = payerRequirements[selectedPayer];
            if (!requirements) return;
            
            // Update checklist with payer-specific requirements
            updateDynamicChecklist(selectedPayer, requirements);
            
            // Update field styling based on requirements
            updateFieldStyling(requirements);
            
            // Update confidence text
            const confidenceText = document.getElementById('confidenceText');
            confidenceText.textContent = requirements.specific || 'Complete all required fields for this payer.';
            
            // Recalculate confidence
            updateConfidence();
        }

        // Reset to default checklist
        function resetToDefaultChecklist() {
            const checklistContent = document.getElementById('checklistContent');
            checklistContent.innerHTML = `
                <div class="checklist-item">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-yellow-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        <span class="text-sm font-semibold text-gray-700">Select Insurance Payer</span>
                    </div>
                    <p class="ml-7 text-xs text-gray-500 mt-1">Required to determine specific authorization requirements</p>
                </div>
            `;
        }

        // Update dynamic checklist based on payer
        function updateDynamicChecklist(payer, requirements) {
            const checklistContent = document.getElementById('checklistContent');
            checklistContent.innerHTML = '';
            
            // Add required fields
            requirements.required.forEach(fieldId => {
                const isComplete = checkFieldComplete(fieldId);
                const item = createChecklistItem(fieldId, isComplete, true);
                checklistContent.appendChild(item);
            });
            
            // Add optional fields (if configured to show)
            if (document.getElementById('showOptionalFields')?.checked) {
                requirements.optional.forEach(fieldId => {
                    const isComplete = checkFieldComplete(fieldId);
                    const item = createChecklistItem(fieldId, isComplete, false);
                    checklistContent.appendChild(item);
                });
            }
        }

        // Create checklist item element
        function createChecklistItem(fieldId, isComplete, isRequired) {
            const div = document.createElement('div');
            div.className = 'checklist-item flex items-start';
            div.dataset.fieldId = fieldId;
            
            const iconColor = isComplete ? 'text-green-500' : (isRequired ? 'text-yellow-500' : 'text-gray-400');
            const iconPath = isComplete ? 
                'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' : 
                'M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z';
            
            div.innerHTML = `
                <svg class="w-5 h-5 ${iconColor} mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${iconPath}"></path>
                </svg>
                <span class="text-sm ${isComplete ? 'text-gray-700' : 'text-gray-700 font-semibold'}">
                    ${fieldLabels[fieldId] || fieldId}
                    ${!isRequired ? ' (Optional)' : ''}
                </span>
            `;
            
            return div;
        }

        // Check if a field is complete
        function checkFieldComplete(fieldId) {
            if (fieldId === 'stepTherapy') {
                // Check if at least one step therapy entry exists
                const stepTherapies = document.querySelectorAll('#stepTherapyList input[placeholder="Metformin"]');
                return stepTherapies.length > 0 && stepTherapies[0].value.trim() !== '';
            } else if (fieldId === 'documents') {
                // Check if files have been uploaded
                return document.getElementById('fileList').children.length > 0;
            } else {
                // Check regular form fields
                const field = document.getElementById(fieldId);
                return field && field.value.trim() !== '';
            }
        }

        // Update field styling based on requirements
        function updateFieldStyling(requirements) {
            // Reset all fields
            document.querySelectorAll('input, select, textarea').forEach(field => {
                field.classList.remove('payer-required', 'payer-optional');
            });
            
            // Style required fields
            requirements.required.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.classList.add('payer-required');
            });
            
            // Style optional fields
            requirements.optional.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.classList.add('payer-optional');
            });
        }

        // Update checklist when form changes
        function updateChecklist() {
            const selectedPayer = document.getElementById('payerSelect').value;
            if (!selectedPayer) return;
            
            const requirements = payerRequirements[selectedPayer];
            if (!requirements) return;
            
            // Update each checklist item
            document.querySelectorAll('.checklist-item').forEach(item => {
                const fieldId = item.dataset.fieldId;
                if (!fieldId) return;
                
                const isComplete = checkFieldComplete(fieldId);
                const icon = item.querySelector('svg');
                const text = item.querySelector('span');
                
                if (isComplete) {
                    icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>';
                    icon.classList.remove('text-yellow-500');
                    icon.classList.add('text-green-500');
                    text.classList.remove('font-semibold');
                }
            });
            
            updateConfidence();
        }

        // Update confidence score
        function updateConfidence() {
            const selectedPayer = document.getElementById('payerSelect').value;
            if (!selectedPayer) {
                updateConfidenceDisplay(12, 'red');
                return;
            }
            
            const requirements = payerRequirements[selectedPayer];
            const requiredFields = requirements.required;
            const completedCount = requiredFields.filter(fieldId => checkFieldComplete(fieldId)).length;
            const percentage = Math.round((completedCount / requiredFields.length) * 100);
            
            let color = 'red';
            if (percentage >= 80) color = 'green';
            else if (percentage >= 50) color = 'yellow';
            
            updateConfidenceDisplay(percentage, color);
            
            // Enable/disable submit button
            const submitBtn = document.getElementById('submitBtn');
            if (percentage === 100) {
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                submitBtn.classList.add('hover:bg-blue-700');
            } else {
                submitBtn.disabled = true;
                submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
                submitBtn.classList.remove('hover:bg-blue-700');
            }
        }

        // Update confidence display
        function updateConfidenceDisplay(percentage, color) {
            const score = document.getElementById('confidenceScore');
            const bar = document.getElementById('confidenceBar');
            
            score.textContent = percentage + '%';
            score.className = `text-2xl font-bold text-${color}-600`;
            bar.style.width = percentage + '%';
            bar.className = `bg-${color}-500 h-2.5 rounded-full transition-all duration-300`;
        }

        // Add step therapy entry
        function addStepTherapy() {
            const stepTherapyList = document.getElementById('stepTherapyList');
            const newEntry = document.createElement('div');
            newEntry.className = 'bg-gray-50 p-4 rounded-lg';
            newEntry.innerHTML = `
                <div class="grid grid-cols-2 gap-4 mb-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Previous Medication</label>
                        <input type="text" placeholder="Medication name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Duration</label>
                        <input type="text" placeholder="Duration" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Reason for Discontinuation</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm">
                        <option value="">Select reason...</option>
                        <option value="ineffective">Ineffective/Inadequate response</option>
                        <option value="side-effects">Intolerable side effects</option>
                        <option value="contraindicated">Contraindicated</option>
                        <option value="allergic">Allergic reaction</option>
                    </select>
                </div>
            `;
            stepTherapyList.appendChild(newEntry);
        }

        // File upload handlers
        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const dropzone = document.getElementById('dropzone');
            dropzone.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            handleFiles(files);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const dropzone = document.getElementById('dropzone');
            dropzone.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const dropzone = document.getElementById('dropzone');
            dropzone.classList.remove('dragover');
        }

        function handleFiles(files) {
            const fileList = document.getElementById('fileList');
            
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'flex items-center justify-between p-2 bg-gray-50 rounded';
                fileItem.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-4 h-4 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <span class="text-sm text-gray-700">${file.name}</span>
                        <span class="text-xs text-gray-500 ml-2">(${(file.size / 1024).toFixed(1)} KB)</span>
                    </div>
                    <button onclick="this.parentElement.remove(); updateChecklist();" class="text-red-500 hover:text-red-700">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                `;
                fileList.appendChild(fileItem);
            });
            
            updateChecklist();
        }

        // Add event listeners to all form fields
        document.addEventListener('DOMContentLoaded', () => {
            const formInputs = document.querySelectorAll('input, select, textarea');
            formInputs.forEach(input => {
                input.addEventListener('input', updateChecklist);
                input.addEventListener('change', updateChecklist);
            });
        });
    </script>
</body>
</html> 